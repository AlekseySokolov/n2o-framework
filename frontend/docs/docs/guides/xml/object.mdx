---
title: Объект
description: ""
---

**Тип метаданных**

`object`

**Библиотека компонентов**

```
http://n2oapp.net/framework/config/schema/object-4.0
```

**Атрибуты**

|Наименование |Тип   |Описание                                           |Значение по умолчанию|
|-------------|------|---------------------------------------------------|---------------------|
|name         |Строка|Наименование объекта                               |                     |
|table-name   |Строка|Наименование таблицы БД, ассоциированной с объектом|                     |
|service-class|Строка|Класс сервиса, выполняющего действия над объектом  |                     |
|service-name |Строка|Имя сервиса, выполняющего действия над объектом    |                     |
|app-name     |Строка|Имя приложения, содержащего объект                 |                     |
|module-name  |Строка|Имя модуля, содержащего объект                     |                     |

**Пример**

```xml
<object xmlns="http://n2oapp.net/framework/config/schema/object-4.0"
  name="Мой объект"
  table-name="mytable"
  entity-class="com.example.MyEntity">
  ...
</object>
```

### &lt;fields&gt;

Поля объекта.

#### &lt;field&gt; {#field2}

Простое поле объекта.

**Атрибуты**

|Наименование |Тип                             |Описание                                              |Значение по умолчанию|
|-------------|--------------------------------|------------------------------------------------------|---------------------|
|id           |Строка                          |Идентификатор поля                                    |                     |
|default-value|Строка                          |Значение по умолчанию                                 |                     |
|domain       |[Тип данных](../xml/base#Data_types_domain)|Тип данных поля                            |                     |
|normalize    |Строка                          |SpEL выражение, применяемое к значению перед маппингом|                     |
|mapping      |Строка                          |Маппинг значения в сущность или провайдер данных      |                     |
|required     |true false                      |Обязательность поля                                   |false                |
|enabled      |Строка                          |Условие, при котором должен быть выполнен маппинг     |                     |

**Пример**

```xml
<fields>
  <field id="birthday" domain="date" mapping="['birthDate']"/>
</fields>
```

#### &lt;reference&gt;

Составное поле.

**Атрибуты**

|Наименование|Тип       |Описание                                              |Значение по умолчанию                                   |
|------------|----------|------------------------------------------------------|--------------------------------------------------------|
|id          |Строка    |Идентификатор ссылки                                  |                                                        |
|object-id   |Ссылка    |Объект, в котором представлено описание поля          |                                                        |
|entity-class|Строка    |Класс сущности, на который ссылается поле             |Определяется по атрибуту `entity-class` у объекта ссылки|
|normalize   |Строка    |SpEL выражение, применяемое к значению перед маппингом|                                                        |
|mapping     |Строка    |Маппинг составного поля в параметр провайдера         |                                                        |
|required    |true false|Обязательность поля                                   |false                                                   |
|enabled     |Строка    |Условие, при котором должен быть выполнен маппинг     |                                                        |

**Тело**

Список &lt;field&gt;, &lt;reference&gt;, &lt;list&gt;, &lt;set&gt; полей

:::note

Если тело пустое, то маппинг и преобразование дочерних полей не будет производиться.
Если не пустое, то только для тех, что перечислены.

:::

**Пример**

```xml
<fields>
  <reference id="person" mapping="['person']">
    <field id="id" mapping="['id']"/>
    <field id="name" mapping="['name']"/>
    <set id="phones" mapping="['phones']" object-id="phone"/>
    <list id="addresses" mapping="['addresses']" object-id="address"/>
  </reference>
</fields>
```

#### &lt;list&gt;

Поле - список объектов.

**Атрибуты**

Аналогичны `<reference>`.

**Пример**

```xml
<fields>
  <list id="statuses" mapping="['statusList']">
    <field id="id" mapping="['id]'"/>
    <field id="name" mapping="['name']"/>
    <list id="codes" mapping="['codes']" object-id="code"/>
  </list>
</fields>
```

#### &lt;set&gt;

Поле - множество объектов.

**Атрибуты**

Аналогичны `<reference>`.

**Пример**

```xml
<fields>
  <set id="statuses" mapping="['statusSet']">
    <field id="id" mapping="['id]'"/>
    <field id="name" mapping="['name']"/>
    <list id="codes" mapping="['codes']" object-id="code"/>
  </set>
</fields>
```

### &lt;operations&gt;

Список операций над объектом.

#### &lt;operation&gt; {#operation}

Операция над объектом.

**Атрибуты**

|Наименование |Тип                    |Описание                                          |Значение по умолчанию                                                                                   |
|-------------|-----------------------|--------------------------------------------------|--------------------------------------------------------------------------------------------------------|
|id           |Строка                 |Идентификатор операции                            |                                                                                                        |
|name         |Строка                 |Наименование операции                             |                                                                                                        |
|submit-label |Строка                 |Наименование кнопки отправки операции             |Если `id` равен `create`, `update`, `save`, `persist`, то - "Сохранить". В иных случаях - "Подтвердить".|
|description  |Текст                  |Описание операции                                 |                                                                                                        |
|success-text |Параметризованный текст|Текст сообщения в случае успеха                   |Данные сохранены                                                                                        |
|success-title|Параметризованный текст|Заголовок сообщения в случае успеха               |                                                                                                        |
|fail-text    |Параметризованный текст|Текст сообщения в случае непредвиденной ошибки    |Не удалось выполнить действие                                                                           |
|fail-title   |Параметризованный текст|Заголовок сообщения в случае непредвиденной ошибки|                                                                                                        |
|confirm      |true false             |Требуется ли подтверждение действия?              |                                                                                                        |
|confirm-text |Параметризованный текст|Текст подтверждения действия                      |Вы уверены, что хотите выполнить действие?                                                              |

**Пример**

```xml
<operations>
  <operation
    id="update"
    name="Изменение"
    success-text="Запись успешно изменена"
    fail-text="Не удалось изменить запись">
    <invocation>
      <sql>UPDATE mytable SET name = :name WHERE id = :id</sql>
    </invocation>
    <in>
      <field id="id" mapping="id" required="true"/>
      <field id="name" mapping="name"/>
    </in>
    <fail-out>
      <field id="message" mapping="#this.getMessage()"/>
    </fail-out>
    <validations white-list="checkUniqueName"/>
  </operation>
</operations>
```

##### &lt;invocation&gt;

Вызов операции.

**Атрибуты**

|Наименование   |Тип    |Описание                               |Значение по умолчанию|
|---------------|-------|---------------------------------------|---------------------|
|result-mapping |Строка |Маппинг результата выполнения операции |                     |

**Тело**

[Провайдер данных](../xml/dataprovider)

```xml
<invocation result-mapping="['data']">
    <graphql>...</graphql>
</invocation>
```

### Параметры операций {#Operation_parameter}

Базовые свойства параметров операций

**Атрибуты**

|Наименование |Тип       |Описание                                     |Значение по умолчанию|
|-------------|----------|---------------------------------------------|---------------------|
|id           |Строка    |Идентификатор параметра                      |                     |
|default-value|Строка    |Значение по умолчанию                        |                     |
|domain       |Домены    |Тип данных                                   |                     |
|normalize    |Строка    |SpEL выражение, изменяющее значение параметра|                     |
|mapping      |Строка    |Выражение маппинга                           |                     |

#### Свойства входящих параметров

В качестве входящих параметров могут быть, как простые поля &lt;field&gt;, так и составные: &lt;reference&gt;, &lt;list&gt;, &lt;set&gt;.

**Атрибуты**

|Наименование       |Тип   |Описание                                         |Значение по умолчанию|
|-------------------|------|-------------------------------------------------|---------------------|
|param              |Строка|Параметр содержащий url                          |                     |
|validation-fail-key|Строка|Код ошибки валидации с сервера                   |                     |
|entity-class       |Строка|Класс, которому соответствует параметр           |                     |
|required           |true false|Обязательность параметра                     |false                |
|enabled            |Строка|Условие, при котором должен быть выполнен маппинг|                     |

**Тело**

Если составное поле, то может содержать список любых видов полей

**Пример**
```xml
<in>
  <field id="gender*.id" domain="integer[]" mapping="genders" param="param"/>
  <list id="ratings" mapping="ratings">
    <field id="code" mapping="code"/>
    <field id="name" mapping="name"/>
  </list>
  <reference id="address">
    <field id="city"/>
    <field id="street"/>
    <field id="home"/>
  </reference>
</in>
```

#### Свойства исходящих параметров

В качестве исходящих параметров могут быть как простые поля &lt;field&gt;, так и составные: &lt;reference&gt;, &lt;list&gt;, &lt;set&gt;.
В отличие от входящих не имеют дополнительных атрибутов.

**Пример**

```xml
<out>
    <field id="gender*.id" domain="integer[]" mapping="genders" param="param"/>
    <reference id="address">
        <field id="city" mapping="city"/>
        <field id="street" mapping="street"/>
        <field id="home" mapping="home"/>
    </reference>
    <list id="ratings" mapping="ratings">
      <field id="code" mapping="code"/>
      <field id="name" mapping="name"/>
    </list>
</out>
```

**Дополнение**

Если в объекте определено поле в разделе &lt;fields&gt;, в параметре указано `id` поля, то не заполненные атрибуты в параметр будут скопированы из поля.

**Пример**

```xml
<object>
    <fields>
        <reference id="address">
            <field id="city" mapping="city"/>
            <field id="street" mapping="street"/>
            <field id="home" mapping="home"/>
        </reference>
        <list id="ratings" mapping="ratings">
          <field id="code" mapping="code"/>
          <field id="name" mapping="name"/>
        </list>
    </fields>
<out>
    <field id="gender*.id" domain="integer[]" mapping="genders" param="param"/>
    <field id="address"/>
    <field id="ratings"/>
</out>
</object>
```

Исходящие параметры в случае ошибки операции. Может быть только простое поле &lt;field&gt;

```xml
<fail-out>
  <field id="message" mapping="#this.getMessage()"/>
</fail-out>
```


**Тело**

Список [параметров](../xml/object#Operation_parameter)

##### &lt;validations&gt;

Список валидаций операции.

**Атрибуты**

|Наименование|Тип                                 |Описание                                                                      |Значение по умолчанию|
|------------|------------------------------------|------------------------------------------------------------------------------|---------------------|
|white-list  |Список идентификаторов через запятую|Список валидаций, которые будут вызваны перед или после выполнения операции   |Все валидации объекта|
|black-list  |Список идентификаторов через запятую|Список валидаций, которые не будут вызваны перед или после выполнения операции|                     |

**Тело**

[Список валидаций](#validations3)

### &lt;validations&gt; {#validations3}

Валидации объекта.

#### Базовые свойства {#Basic_properties}

**Атрибуты**

|Наименование |Тип                                                                                                                 |Описание                                                                    |Значение по умолчанию                                                                   |
|-------------|--------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------|----------------------------------------------------------------------------------------|
|id           |Строка                                                                                                              |Идентификатор валидации                                                     |                                                                                        |
|severity     |success, info, warning, danger                                                                                      |Уровень важности валидации                                                  |                                                                                        |
|server-moment|before-operation, before-query, after-success-query, after-fail-query, after-success-operation, after-fail-operation|Момент срабатывания валидации на сервере                                    |before-operation при severity равном danger или warning, иначе - after-success-operation|
|message      |Строка                                                                                                              |Сообщение, в случае нарушения валидации. Может содержать параметры          |                                                                                        |
|title        |Строка                                                                                                              |Заголовок сообщения, в случае нарушения валидации. Может содержать параметры|                                                                                        |
|field-id     |Ссылка на поле                                                                                                      |Поле, под которым отобразится сообщение                                     |                                                                                        |
|enabled      |true false                                                                                                          |Включение валидации. Поддерживаются плейсхолдеры условия.                   |true                                                                                    |
|side         |client server client,server                                                                                         |Выполнение на клиенте и/или сервере                                         |client,server                                                                           |

#### &lt;condition&gt;

Валидация условия значений полей.

**Атрибуты**

|Наименование|Тип         |Описание                                                                                            |Значение по умолчанию |
|------------|------------|----------------------------------------------------------------------------------------------------|----------------------|
|on          |Список полей|Поля, от которых зависит условие валидации                                                          |                      |
|src         |Строка      |Путь к js файлу, который содержит условие валидации. Если не задан, необходимо задать условие в теле|                      |

**Тело**

java Script выражение

**Пример**

```xml
<validations>
  <condition
    id="checkAdult"
    field-id="birthday"
    message="Запрещено для детей. Ваш возраст {age} меньше 18."
    on="age">
    age >= 18
  </condition>
</validations>
```

#### &lt;mandatory&gt;

Валидация обязательности заполнения поля.

**Атрибуты**

|Наименование|Тип         |Описание                                                                                            |Значение по умолчанию |
|------------|------------|----------------------------------------------------------------------------------------------------|----------------------|
|field-id    |Ссылка      |Поле, которое должно быть заполнено                                                                 |                      |


**Тело**

JavaScript выражение

:::tip

Вводить javaScript выражение не обязательно.
Будут сделаны стандартные проверки на undefined, null, пустую строку,
наличие id, пустой список

:::

**Пример**

```xml
<validations>
  <mandatory
    id="requiredName"
    field-id="name"
    message="Наименование должно быть заполнено"/>
</validations>
```

#### &lt;constraint&gt;

Валидация ограничений полей.

**Атрибуты**

|Наименование|Тип           |Описание           |Значение по умолчанию|
|------------|--------------|-------------------|---------------------|
|result      |SpEL выражение|Результат валидации|                     |

**Пример**

```xml
<validations>
  <constraint
    id="checkUniqueName"
    field-id="name"
    message="Имя {name} уже существует"
    result="[0].cnt == 0">
    <invocation>
      <sql>
          SELECT count(1) as cnt
          FROM mytable
          WHERE name = :name
            AND (:id is null OR id != :id)
      </sql>
    </invocation>
    <in>
      <field id="name" mapping="name"/>
      <field id="id" mapping="id"/>
    </in>
  </constraint>
</validations>
```

#### &lt;dialog&gt;

Валидация с диалогом выбора.

**Атрибуты**

|Наименование |Тип                                                                                                                 |Описание                                                          |Значение по умолчанию                                                                   |
|-------------|--------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|----------------------------------------------------------------------------------------|
|id           |Строка                                                                                                              |Идентификатор валидации                                           |                                                                                        |
|server-moment|before-operation, before-query, after-success-query, after-fail-query, after-success-operation, after-fail-operation|Момент срабатывания валидации на сервере                          |before-operation при severity равном danger или warning, иначе - after-success-operation|
|title        |Строка                                                                                                              |Заголовок окна с диалогом. Может содержать параметры              |                                                                                        |
|message      |Строка                                                                                                              |Сообщение, в случае нарушения валидации. Может содержать параметры|                                                                                        |
|result       |SpEL выражение                                                                                                      |Результат валидации                                               |                                                                                        |
|size         |sm lg                                                                                                               |Размер окна диалога                                               |lg                                                                                      |

**Пример**

```xml
<validations>
  <dialog
    id="checkName" size="sm"
    message="Имя не Иван. Вы уверены, что хотите продолжить?"
    result="name == 'Ivan'">
    <invocation>...</invocation>
    <in>
      <field id="name"/>
      <field id="validated"/>
      <list id="statuses"/>
    </in>
    <out>
      <field id="name"/>
    </out>
    <toolbar>
      ...
    </toolbar>
  </dialog>
</validations>
```

##### &lt;invocation&gt;

Вызов валидации.

**Тело**

[Провайдер данных](../xml/dataprovider)

##### &lt;in&gt;

Входящие параметры валидации.

**Тело**

Список [параметров](../xml/object#Operation_parameter)

##### &lt;out&gt;

Исходящие параметры валидации.

:::tip

Нужны для параметризации сообщения валидации *message*.

:::

**Тело**

Список [параметров](../xml/object#Operation_parameter)

##### &lt;toolbar&gt;

[Меню управляющих кнопок](../xml/widget#toolbar_in_widget).
